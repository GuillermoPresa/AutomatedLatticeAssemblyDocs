\hypertarget{_lynxmotion_l_s_s_8h_source}{}\doxysection{Lynxmotion\+LSS.\+h}
\label{_lynxmotion_l_s_s_8h_source}\index{C:/Users/Guille/LatticeAssembly (2)/Assets/Resources/Objects/ILLAV3/LSS2MC\_arduinoCode/libraries/AlternativeLSS/src/LynxmotionLSS.h@{C:/Users/Guille/LatticeAssembly (2)/Assets/Resources/Objects/ILLAV3/LSS2MC\_arduinoCode/libraries/AlternativeLSS/src/LynxmotionLSS.h}}
\mbox{\hyperlink{_lynxmotion_l_s_s_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 }
\DoxyCodeLine{2 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{3 }
\DoxyCodeLine{4 \textcolor{preprocessor}{\#if (ARDUINO >= 100)}}
\DoxyCodeLine{5 \textcolor{preprocessor}{ \#include <Arduino.h>}}
\DoxyCodeLine{6 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{7 \textcolor{preprocessor}{ \#include <WProgram.h>}}
\DoxyCodeLine{8 \textcolor{preprocessor}{ \#include <pins\_arduino.h>}}
\DoxyCodeLine{9 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10 \textcolor{preprocessor}{\#include <WString.h>}}
\DoxyCodeLine{11 }
\DoxyCodeLine{12 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_lynxmotion_l_s_s-_config_8h}{LynxmotionLSS-\/Config.h}}"{}}}
\DoxyCodeLine{13 }
\DoxyCodeLine{14 \textcolor{preprocessor}{\#if defined(LSS\_STATS)}}
\DoxyCodeLine{15 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{aggregate_8h}{aggregate.h}}"{}}}
\DoxyCodeLine{16 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{17 }
\DoxyCodeLine{18 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_lss_communication_8h}{LssCommunication.h}}"{}}}
\DoxyCodeLine{19 \textcolor{keyword}{class }\mbox{\hyperlink{class_lynx_servo}{LynxServo}};}
\DoxyCodeLine{20 }
\DoxyCodeLine{21 }
\DoxyCodeLine{22 }
\DoxyCodeLine{23 \textcolor{keyword}{class }\mbox{\hyperlink{class_mask_set}{MaskSet}} }
\DoxyCodeLine{24   \textcolor{comment}{// TODO: rename to AsyncTransaction}}
\DoxyCodeLine{25 \{}
\DoxyCodeLine{26   \textcolor{keyword}{public}:}
\DoxyCodeLine{27     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{class_mask_set_a162c44ca32527dd5da911ca69a971580}{txn}};  \textcolor{comment}{// current transmission number for this request}}
\DoxyCodeLine{28     \mbox{\hyperlink{_lss_communication_8h_aca3a41f855f081418aebab290e251f73}{LssCommands}} \mbox{\hyperlink{class_mask_set_afff5089584e99b47cec55187c3f6d497}{read}};}
\DoxyCodeLine{29     \mbox{\hyperlink{_lss_communication_8h_aca3a41f855f081418aebab290e251f73}{LssCommands}} \mbox{\hyperlink{class_mask_set_a05825642e9156b47878f14710b1b320b}{requested}};}
\DoxyCodeLine{30     \mbox{\hyperlink{_lss_communication_8h_aca3a41f855f081418aebab290e251f73}{LssCommands}} \mbox{\hyperlink{class_mask_set_a58a68ddb3e5e9757753fd463cc5cf982}{completed}};}
\DoxyCodeLine{31 }
\DoxyCodeLine{32     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{class_mask_set_a31c458ad1678d03cc3459784aaad2f8f}{timestamp}};      \textcolor{comment}{// millis when first packet was sent}}
\DoxyCodeLine{33     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{class_mask_set_a28ee97dc59e68200299d31c5de325b1b}{expire}};         \textcolor{comment}{// timestamp when the read request will be considered expired}}
\DoxyCodeLine{34 }
\DoxyCodeLine{35     \textcolor{keyword}{inline} \mbox{\hyperlink{class_mask_set_adb07d853708aa4dd10c65c8e3fe9d57a}{MaskSet}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \_txn = 0, \mbox{\hyperlink{_lss_communication_8h_aca3a41f855f081418aebab290e251f73}{LssCommands}} \_read = \mbox{\hyperlink{_lss_communication_8h_a2dd9d61480418a3483a96280acc67b2e}{LssInvalid}}) : \mbox{\hyperlink{class_mask_set_a162c44ca32527dd5da911ca69a971580}{txn}}(\_txn), \mbox{\hyperlink{class_mask_set_afff5089584e99b47cec55187c3f6d497}{read}}(\_read), \mbox{\hyperlink{class_mask_set_a05825642e9156b47878f14710b1b320b}{requested}}(0), \mbox{\hyperlink{class_mask_set_a58a68ddb3e5e9757753fd463cc5cf982}{completed}}(0), \mbox{\hyperlink{class_mask_set_a31c458ad1678d03cc3459784aaad2f8f}{timestamp}}(0), \mbox{\hyperlink{class_mask_set_a28ee97dc59e68200299d31c5de325b1b}{expire}}(0) \{\}}
\DoxyCodeLine{36 }
\DoxyCodeLine{37     \textcolor{keyword}{inline} \textcolor{keywordtype}{bool} \mbox{\hyperlink{class_mask_set_ab95c4ff7ff21f82b41b95d4ef7e75d62}{isActive}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{class_mask_set_a162c44ca32527dd5da911ca69a971580}{txn}}!=0; \}}
\DoxyCodeLine{38     \textcolor{keyword}{inline} \textcolor{keywordtype}{bool} \mbox{\hyperlink{class_mask_set_af515ed6ee71b3543fe9c79131bd7a7f3}{isComplete}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{class_mask_set_afff5089584e99b47cec55187c3f6d497}{read}} == \mbox{\hyperlink{class_mask_set_a58a68ddb3e5e9757753fd463cc5cf982}{completed}}; \}}
\DoxyCodeLine{39       \textcolor{keyword}{inline} \textcolor{keywordtype}{bool} \mbox{\hyperlink{class_mask_set_a8777ffb77c9dd0c5e2dfb473ff6f3ab8}{isUnresponsive}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{class_mask_set_a58a68ddb3e5e9757753fd463cc5cf982}{completed}}==0; \}}
\DoxyCodeLine{40 \};}
\DoxyCodeLine{41 }
\DoxyCodeLine{42 \textcolor{keyword}{class }\mbox{\hyperlink{class_async_token}{AsyncToken}}}
\DoxyCodeLine{43 \{}
\DoxyCodeLine{44   \textcolor{keyword}{public}:}
\DoxyCodeLine{45     \mbox{\hyperlink{class_async_token_af5b0e6c6a67dede49e5fb56fce98d9e5}{AsyncToken}}() : \mbox{\hyperlink{class_async_token_aef71502d6b6a20ff66f0cde394f0e0d0}{set}}(NULL) \{\}}
\DoxyCodeLine{46       \mbox{\hyperlink{class_async_token_ad68ab69b5f439045c0024b49288d045c}{AsyncToken}}(\textcolor{keyword}{const} \mbox{\hyperlink{class_async_token}{AsyncToken}}\& copy) : \mbox{\hyperlink{class_async_token_aef71502d6b6a20ff66f0cde394f0e0d0}{set}}(copy.\mbox{\hyperlink{class_async_token_aef71502d6b6a20ff66f0cde394f0e0d0}{set}}) \{\}}
\DoxyCodeLine{47       \mbox{\hyperlink{class_async_token_a0395c33bb8c794b013a9a9462f12e91f}{AsyncToken}}(\textcolor{keyword}{const} \mbox{\hyperlink{class_mask_set}{MaskSet}}\& \_set) : \mbox{\hyperlink{class_async_token_aef71502d6b6a20ff66f0cde394f0e0d0}{set}}(\&\_set) \{\}}
\DoxyCodeLine{48 }
\DoxyCodeLine{49       \textcolor{keyword}{inline} \mbox{\hyperlink{class_async_token}{AsyncToken}}\& \mbox{\hyperlink{class_async_token_a0efc38438f766f2127635ab4cc926d37}{operator=}}(\textcolor{keyword}{const} \mbox{\hyperlink{class_async_token}{AsyncToken}}\& t) \{ \mbox{\hyperlink{class_async_token_aef71502d6b6a20ff66f0cde394f0e0d0}{set}} = t.\mbox{\hyperlink{class_async_token_aef71502d6b6a20ff66f0cde394f0e0d0}{set}}; \textcolor{keywordflow}{return} *\textcolor{keyword}{this}; \}}
\DoxyCodeLine{50       \textcolor{keyword}{inline} \mbox{\hyperlink{class_async_token}{AsyncToken}}\& \mbox{\hyperlink{class_async_token_a9b2221ab3c9c08213ae58448f4263e7f}{operator=}}(\textcolor{keyword}{const} \mbox{\hyperlink{class_mask_set}{MaskSet}}\& s) \{ \mbox{\hyperlink{class_async_token_aef71502d6b6a20ff66f0cde394f0e0d0}{set}} = \&s;  \textcolor{keywordflow}{return} *\textcolor{keyword}{this}; \}}
\DoxyCodeLine{51 }
\DoxyCodeLine{52       \textcolor{comment}{// clear the async token}}
\DoxyCodeLine{53       \textcolor{keyword}{inline} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_async_token_a1a56275ebd5a2192c6f8cb8697db79c9}{clear}}() \{ \mbox{\hyperlink{class_async_token_aef71502d6b6a20ff66f0cde394f0e0d0}{set}} = NULL;  \}}
\DoxyCodeLine{54 }
\DoxyCodeLine{55     \textcolor{keyword}{inline} \textcolor{keywordtype}{bool} \mbox{\hyperlink{class_async_token_a692b108bb1a00c1fa871267dc2173b58}{isValid}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{class_async_token_aef71502d6b6a20ff66f0cde394f0e0d0}{set}}!=NULL; \}}
\DoxyCodeLine{56     \textcolor{keyword}{inline} \textcolor{keywordtype}{bool} \mbox{\hyperlink{class_async_token_aec3951bfe5b21639ae364c2203cebc7e}{isActive}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{class_async_token_aef71502d6b6a20ff66f0cde394f0e0d0}{set}} \&\& \mbox{\hyperlink{class_async_token_aef71502d6b6a20ff66f0cde394f0e0d0}{set}}-\/>\mbox{\hyperlink{class_mask_set_ab95c4ff7ff21f82b41b95d4ef7e75d62}{isActive}}(); \}}
\DoxyCodeLine{57     \textcolor{keyword}{inline} \textcolor{keywordtype}{bool} \mbox{\hyperlink{class_async_token_a0a3c5ffeca1875799e9a4c66104c5455}{isComplete}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{class_async_token_aef71502d6b6a20ff66f0cde394f0e0d0}{set}} \&\& \mbox{\hyperlink{class_async_token_aef71502d6b6a20ff66f0cde394f0e0d0}{set}}-\/>\mbox{\hyperlink{class_mask_set_af515ed6ee71b3543fe9c79131bd7a7f3}{isComplete}}(); \}}
\DoxyCodeLine{58       \textcolor{keyword}{inline} \textcolor{keywordtype}{bool} \mbox{\hyperlink{class_async_token_aa60530228d04a4eec9b1a798b7eab945}{isUnresponsive}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{class_async_token_aef71502d6b6a20ff66f0cde394f0e0d0}{set}} \&\& \mbox{\hyperlink{class_async_token_aef71502d6b6a20ff66f0cde394f0e0d0}{set}}-\/>\mbox{\hyperlink{class_mask_set_a8777ffb77c9dd0c5e2dfb473ff6f3ab8}{isUnresponsive}}(); \}}
\DoxyCodeLine{59   }
\DoxyCodeLine{60     \textcolor{comment}{// returns an async token that indicates an unresponsive device/servo}}
\DoxyCodeLine{61     \textcolor{keyword}{static} \mbox{\hyperlink{class_async_token}{AsyncToken}} \mbox{\hyperlink{class_async_token_acd4f2a396228952697a3b5fe233cdc84}{Unresponsive}}() \{}
\DoxyCodeLine{62       \textcolor{keyword}{static} \mbox{\hyperlink{class_mask_set}{MaskSet}} um(0, \mbox{\hyperlink{_lss_communication_8h_af617bb43659fc42cb97c149ea061097e}{LssQuery}});}
\DoxyCodeLine{63       \textcolor{keywordflow}{return} \mbox{\hyperlink{class_async_token_af5b0e6c6a67dede49e5fb56fce98d9e5}{AsyncToken}}(um);}
\DoxyCodeLine{64     \}}
\DoxyCodeLine{65 }
\DoxyCodeLine{66 \textcolor{keyword}{protected}:}
\DoxyCodeLine{67     \textcolor{keyword}{const} \mbox{\hyperlink{class_mask_set}{MaskSet}}* \mbox{\hyperlink{class_async_token_aef71502d6b6a20ff66f0cde394f0e0d0}{set}};}
\DoxyCodeLine{68 \};}
\DoxyCodeLine{69 }
\DoxyCodeLine{70 \textcolor{keyword}{class }\mbox{\hyperlink{class_lynx_channel}{LynxChannel}} \{}
\DoxyCodeLine{71   \textcolor{comment}{// They say classes shouldnt be friends, but then why bother have the friend feature? Besides, I}}
\DoxyCodeLine{72   \textcolor{comment}{// will take performance and simplicity over they-\/say for embedded systems.}}
\DoxyCodeLine{73   \textcolor{keyword}{friend} \textcolor{keyword}{class }\mbox{\hyperlink{class_lynx_servo}{LynxServo}};}
\DoxyCodeLine{74   }
\DoxyCodeLine{75   \textcolor{keyword}{public}: \textcolor{comment}{// todo: should be private}}
\DoxyCodeLine{76     \textcolor{keyword}{const} \textcolor{keywordtype}{char}* \mbox{\hyperlink{class_lynx_channel_aa5f945e63fe5c7bb0fd58f9e30dd3b6f}{name}};}
\DoxyCodeLine{77     Stream* \mbox{\hyperlink{class_lynx_channel_a7c07017e4ed6ca14be4df09cf37d5fab}{serial}};}
\DoxyCodeLine{78     \textcolor{keywordtype}{char} \mbox{\hyperlink{class_lynx_channel_ad355c1a177e558a813b55126e05fc058}{buffer}}[32];}
\DoxyCodeLine{79     \textcolor{keywordtype}{char}* \mbox{\hyperlink{class_lynx_channel_ad44dae41773de5c5a3b6308d924540fc}{pbuffer}};}
\DoxyCodeLine{80 }
\DoxyCodeLine{81     \textcolor{comment}{// parameters}}
\DoxyCodeLine{82     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{class_lynx_channel_a061c1a39b97ab3d7259ae187d3d6abf9}{timeout\_usec}};     \textcolor{comment}{// time we will wait for a servo to respond (in microseconds)}}
\DoxyCodeLine{83     \textcolor{keywordtype}{short} \mbox{\hyperlink{class_lynx_channel_a9c7e171af7e4d4ba5b38e1df90678fda}{unresponsive\_request\_limit}};       \textcolor{comment}{// if a servo fails to respond to this number of packets in a row, we consider it unresponsive}}
\DoxyCodeLine{84     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{class_lynx_channel_a45b1bb14c4e5a1f810848190aedf237d}{unresponsive\_disable\_interval}};  \textcolor{comment}{// amount of milliseconds a servo gets disabled when found unresponsive}}
\DoxyCodeLine{85 }
\DoxyCodeLine{86     \textcolor{comment}{// servo collection}}
\DoxyCodeLine{87     \textcolor{keywordtype}{short} \mbox{\hyperlink{class_lynx_channel_a9fc4cc190fe7f3568e07a2c5a2f84e88}{size}};}
\DoxyCodeLine{88     \textcolor{keywordtype}{short} \mbox{\hyperlink{class_lynx_channel_a265ff6c7d6e7babf29b231c7f4917a37}{count}};}
\DoxyCodeLine{89     \mbox{\hyperlink{class_lynx_servo}{LynxServo}}** \mbox{\hyperlink{class_lynx_channel_aee74e056213cdb16d4631cf8af432015}{servos}};}
\DoxyCodeLine{90 }
\DoxyCodeLine{91     \textcolor{comment}{// packet queue}}
\DoxyCodeLine{92     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{class_lynx_channel_ae5d2be295cea8d4dbb4a17eb559d6ace}{txn\_current}};  \textcolor{comment}{// transmission number we are sending now}}
\DoxyCodeLine{93     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{class_lynx_channel_adfbc8908bffe0a6be44f09c44c916eae}{txn\_next}};     \textcolor{comment}{// next transmission number we will assign}}
\DoxyCodeLine{94     }
\DoxyCodeLine{95   \textcolor{keyword}{public}:}
\DoxyCodeLine{96     \mbox{\hyperlink{class_lynx_channel_ab64cfb8184e0e5ed73f1a0af3e1cebed}{LynxChannel}}(\textcolor{keyword}{const} \textcolor{keywordtype}{char}* channel\_name=NULL);}
\DoxyCodeLine{97     \textcolor{keyword}{virtual} \mbox{\hyperlink{class_lynx_channel_a21f3cf12ea83fec63bda1c6dfdba98c2}{\string~LynxChannel}}();}
\DoxyCodeLine{98 }
\DoxyCodeLine{99     \textcolor{keywordtype}{void} \mbox{\hyperlink{class_lynx_channel_a1587d09550fe2da8af61605d6b652e5f}{free}}();}
\DoxyCodeLine{100 }
\DoxyCodeLine{101     \textcolor{keywordtype}{void} \mbox{\hyperlink{class_lynx_channel_a68560724488869e57eb51a1d951f2a9a}{begin}}(Stream\& \mbox{\hyperlink{class_lynx_channel_a7c07017e4ed6ca14be4df09cf37d5fab}{serial}});}
\DoxyCodeLine{102     \textcolor{keywordtype}{void} \mbox{\hyperlink{class_lynx_channel_af28230bf8113555b7b4ff9dc8c5c5c5b}{update}}();}
\DoxyCodeLine{103 }
\DoxyCodeLine{104     \mbox{\hyperlink{class_lynx_channel}{LynxChannel}}\& \mbox{\hyperlink{class_lynx_channel_a8f80ae4a34e455ae20009ef7c0f3e6f5}{add}}(\mbox{\hyperlink{class_lynx_servo}{LynxServo}}\& servo);}
\DoxyCodeLine{105 }
\DoxyCodeLine{106     \textcolor{keywordtype}{bool} \mbox{\hyperlink{class_lynx_channel_a7ab1e2a500d336d4d98c79cfa276848f}{contains}}(\textcolor{keywordtype}{short} servoId) \textcolor{keyword}{const};}
\DoxyCodeLine{107     \textcolor{keyword}{const} \mbox{\hyperlink{class_lynx_servo}{LynxServo}}\& \mbox{\hyperlink{class_lynx_channel_ac4fceb7ba7a1e72b63f4e7056f2d195c}{operator[]}}(\textcolor{keywordtype}{short} servoId) \textcolor{keyword}{const};}
\DoxyCodeLine{108     \mbox{\hyperlink{class_lynx_servo}{LynxServo}}\& \mbox{\hyperlink{class_lynx_channel_ac4fceb7ba7a1e72b63f4e7056f2d195c}{operator[]}}(\textcolor{keywordtype}{short} servoId);}
\DoxyCodeLine{109 }
\DoxyCodeLine{110     \textcolor{keywordtype}{short} \mbox{\hyperlink{class_lynx_channel_ac1b3120ab2efe654abd18138edab6f63}{scan}}(\textcolor{keywordtype}{short} beginId, \textcolor{keywordtype}{short} endId);}
\DoxyCodeLine{111 }
\DoxyCodeLine{112     \textcolor{keywordtype}{void} \mbox{\hyperlink{class_lynx_channel_a28a82f004b304115111b8035b210ab60}{create}}(\textcolor{keyword}{const} \textcolor{keywordtype}{short}* ids, \textcolor{keywordtype}{short} N);}
\DoxyCodeLine{113 }
\DoxyCodeLine{114     \textcolor{keyword}{template}<\textcolor{keywordtype}{size\_t} N>}
\DoxyCodeLine{115     \textcolor{keyword}{inline} \textcolor{keywordtype}{void} \mbox{\hyperlink{class_lynx_channel_acd6aa994bacfc37f0ac2b158c2f52b92}{create}}(\textcolor{keyword}{const} \textcolor{keywordtype}{short} (\&ids)[N]) \{ \mbox{\hyperlink{class_lynx_channel_acd6aa994bacfc37f0ac2b158c2f52b92}{create}}(ids, N); \}}
\DoxyCodeLine{116 }
\DoxyCodeLine{117     \textcolor{comment}{// perform a read }}
\DoxyCodeLine{118     \mbox{\hyperlink{class_async_token}{AsyncToken}} \mbox{\hyperlink{class_lynx_channel_a1ec52c86990507f151b11e7922d13532}{ReadAsyncAll}}(\mbox{\hyperlink{_lss_communication_8h_aca3a41f855f081418aebab290e251f73}{LssCommands}} commands);}
\DoxyCodeLine{119 }
\DoxyCodeLine{120     \textcolor{comment}{// wait for an async operation to finish}}
\DoxyCodeLine{121     \textcolor{keywordtype}{bool} \mbox{\hyperlink{class_lynx_channel_a870c0c666ae0963db764efa852f33f1f}{waitFor}}(\textcolor{keyword}{const} \mbox{\hyperlink{class_async_token}{AsyncToken}}\& token);}
\DoxyCodeLine{122     }
\DoxyCodeLine{123     \textcolor{keywordtype}{void} \mbox{\hyperlink{class_lynx_channel_a397af6aead7e025fa3924758088e7584}{send}}(\textcolor{keyword}{const} \mbox{\hyperlink{class_lynx_packet}{LynxPacket}}\& p);}
\DoxyCodeLine{124 }
\DoxyCodeLine{125   \textcolor{keyword}{protected}:}
\DoxyCodeLine{126     }
\DoxyCodeLine{127     \textcolor{keywordtype}{void} \mbox{\hyperlink{class_lynx_channel_aa7909de9971dd8098872e72cc9543de8}{alloc}}(\textcolor{keywordtype}{short} n);}
\DoxyCodeLine{128 }
\DoxyCodeLine{129 \};}
\DoxyCodeLine{130 }
\DoxyCodeLine{131 \textcolor{keyword}{typedef} \textcolor{keyword}{struct }\mbox{\hyperlink{struct___lss_servo_config}{\_LssServoConfig}} \{}
\DoxyCodeLine{132     \textcolor{keywordtype}{short} \mbox{\hyperlink{struct___lss_servo_config_a3c3cb4d11fe383a27bb3a4cbc479a70b}{firstPosition}};}
\DoxyCodeLine{133     \textcolor{keywordtype}{byte} \mbox{\hyperlink{struct___lss_servo_config_aa41c68d50d80833428edb10f7d1071a6}{gyreDirection}};}
\DoxyCodeLine{134     \textcolor{keywordtype}{int} \mbox{\hyperlink{struct___lss_servo_config_a680df80aae8ba7842f418d5d3a7cd4b6}{baudrate}};}
\DoxyCodeLine{135     \mbox{\hyperlink{_lss_communication_8h_a737ab0892820ed129f0d630a2c8fa298}{LssColors}} \mbox{\hyperlink{struct___lss_servo_config_a424354a06cd11518b1f017170a48dc27}{ledColor}};}
\DoxyCodeLine{136     \textcolor{keywordtype}{short} \mbox{\hyperlink{struct___lss_servo_config_a1f9c6978bf100ae624130769eb051de9}{angularStiffness}};}
\DoxyCodeLine{137     \textcolor{keywordtype}{short} \mbox{\hyperlink{struct___lss_servo_config_a817ebbad723b88cb648f9dc2dcba29e2}{angularRange}};}
\DoxyCodeLine{138     \textcolor{keywordtype}{short} \mbox{\hyperlink{struct___lss_servo_config_ac7f10e68826be1e640bebbe383d7ef43}{maxSpeed}};}
\DoxyCodeLine{139     \textcolor{keywordtype}{byte} \mbox{\hyperlink{struct___lss_servo_config_a4af801e16211ae9eecc41503c9896667}{wheelMode}};}
\DoxyCodeLine{140   \textcolor{keywordtype}{char} \mbox{\hyperlink{struct___lss_servo_config_a00dd51d5e86934a981fb36706cb5559c}{firmware}}[16];}
\DoxyCodeLine{141 \} \mbox{\hyperlink{_lynxmotion_l_s_s_8h_a8020bb249f72428e24a9e5ee3f1f41de}{LssServoConfig}};}
\DoxyCodeLine{142 }
\DoxyCodeLine{143 }
\DoxyCodeLine{144 \textcolor{keyword}{class }\mbox{\hyperlink{class_lynx_servo}{LynxServo}} \{}
\DoxyCodeLine{145   \textcolor{comment}{/* TODO}}
\DoxyCodeLine{146 \textcolor{comment}{   *  * Implement improved servo timeouts}}
\DoxyCodeLine{147 \textcolor{comment}{   *      . Track last N time-\/to-\/first-\/packet response-\/times (TTFR) as a rolling average (say N=5)}}
\DoxyCodeLine{148 \textcolor{comment}{   *      . Each transaction has it's timeout set to TTFR plus a factor  (so we quickly detect timeouts)}}
\DoxyCodeLine{149 \textcolor{comment}{   *      . On X timeouts we disable servo for Y millis, and/or}}
\DoxyCodeLine{150 \textcolor{comment}{   *      . On timeout we reset timeout threshold (TOTH) to high value, but as TTFR drops we decay the timeout threshold based on a decay factor of TOTH-\/TTFR}}
\DoxyCodeLine{151 \textcolor{comment}{   */}}
\DoxyCodeLine{152   \textcolor{keyword}{public}:}
\DoxyCodeLine{153     \textcolor{keywordtype}{short} \mbox{\hyperlink{class_lynx_servo_a92716bb302b5dfe94313363ac0b06847}{id}};}
\DoxyCodeLine{154     \mbox{\hyperlink{class_lynx_channel}{LynxChannel}}* \mbox{\hyperlink{class_lynx_servo_a03219603fea7a796150bf9f162466247}{channel}};}
\DoxyCodeLine{155     }
\DoxyCodeLine{156   \textcolor{keyword}{public}:}
\DoxyCodeLine{157     \textcolor{keywordtype}{bool} \mbox{\hyperlink{class_lynx_servo_ac51e6ad4a3657ad1413bdec03c6ccd2c}{channel\_owned}}; \textcolor{comment}{// if true, the servo object memory is owned by the channel (ex. discovered via bus scan)}}
\DoxyCodeLine{158 }
\DoxyCodeLine{159     \textcolor{comment}{// default units for commands}}
\DoxyCodeLine{160     \mbox{\hyperlink{_lss_communication_8h_aca3a41f855f081418aebab290e251f73}{LssCommands}} \mbox{\hyperlink{class_lynx_servo_aec1c31886cd3e65de8ba64e621211326}{units}};}
\DoxyCodeLine{161     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{class_lynx_servo_ac91b03ae79ab7c0e96bce62defbe0d43}{timeout\_usec}};}
\DoxyCodeLine{162 }
\DoxyCodeLine{163     \textcolor{comment}{// if a servo becomes unresponse, we mark if as disabled}}
\DoxyCodeLine{164     \textcolor{keyword}{mutable} \textcolor{keywordtype}{short} \mbox{\hyperlink{class_lynx_servo_a7a55721c41d59145b99ceebe98b81462}{timeouts}};}
\DoxyCodeLine{165     \textcolor{keyword}{mutable} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{class_lynx_servo_a9b1d3c9e712bf07b1ad032f8c89ed3cc}{enableAfter\_millis}}; \textcolor{comment}{// at what millis() time we will allow a retry}}
\DoxyCodeLine{166 }
\DoxyCodeLine{167     \textcolor{keywordtype}{short} \mbox{\hyperlink{class_lynx_servo_a16b6a2444594ba287272990f375bcd9e}{state}};}
\DoxyCodeLine{168     \textcolor{keywordtype}{short} \mbox{\hyperlink{class_lynx_servo_af04ebffa09401bafc00d98635707f956}{position}};}
\DoxyCodeLine{169     \textcolor{keywordtype}{short} \mbox{\hyperlink{class_lynx_servo_a2a8ea22e904281187013f437d26904f7}{target}};}
\DoxyCodeLine{170     \textcolor{keywordtype}{short} \mbox{\hyperlink{class_lynx_servo_a8bdd5ab664446731c65f81b9690b085e}{speed}};}
\DoxyCodeLine{171     \textcolor{keywordtype}{short} \mbox{\hyperlink{class_lynx_servo_aece4532c541865c87cf598f6f8998c03}{current}};}
\DoxyCodeLine{172     \textcolor{keywordtype}{short} \mbox{\hyperlink{class_lynx_servo_a16c30199809a71543181f407179382d1}{voltage}};}
\DoxyCodeLine{173     \textcolor{keywordtype}{short} \mbox{\hyperlink{class_lynx_servo_ada2345272da254c7b324653c8f791469}{temperature}};}
\DoxyCodeLine{174 }
\DoxyCodeLine{175     \textcolor{comment}{// warning: this 'config' variable is typically NULL.}}
\DoxyCodeLine{176     \textcolor{comment}{// config settings are not typically meddled with during normal servo use,}}
\DoxyCodeLine{177     \textcolor{comment}{// so lets store these settings in an external object (that isnt created unless necessary)}}
\DoxyCodeLine{178       \mbox{\hyperlink{struct___lss_servo_config}{LssServoConfig}}* \mbox{\hyperlink{class_lynx_servo_a7792fc1abd09b661d75c32e1811ff82c}{config}};}
\DoxyCodeLine{179 }
\DoxyCodeLine{180     \textcolor{comment}{// variables used during async reads}}
\DoxyCodeLine{181     \mbox{\hyperlink{class_mask_set}{MaskSet}} \mbox{\hyperlink{class_lynx_servo_a5b16d0955c0f23259fd6bce501d6dd8b}{mask}};}
\DoxyCodeLine{182 }
\DoxyCodeLine{183   \textcolor{keyword}{public}:}
\DoxyCodeLine{184 \textcolor{preprocessor}{\#if defined(LSS\_STATS)}}
\DoxyCodeLine{185     \textcolor{comment}{// supplying NULL to \_stats argument will use a global shared Servo stats object (aggregated servo stats)}}
\DoxyCodeLine{186     \textcolor{keyword}{class }\mbox{\hyperlink{class_lynx_servo_1_1_statistics}{Statistics}};}
\DoxyCodeLine{187     \mbox{\hyperlink{class_lynx_servo_a78c0e481dca71cb738a25510406c6726}{LynxServo}}(\textcolor{keywordtype}{short} \_ID, \textcolor{keywordtype}{int} \_units=\mbox{\hyperlink{_lss_communication_8h_a44971e758260958c279fa8c84c7aebaf}{LssDegrees}}, \mbox{\hyperlink{class_lynx_servo_1_1_statistics}{Statistics}}* \_stats=NULL);}
\DoxyCodeLine{188 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{189     \mbox{\hyperlink{class_lynx_servo_a78c0e481dca71cb738a25510406c6726}{LynxServo}}(\textcolor{keywordtype}{short} \_ID, \textcolor{keywordtype}{int} \_units=\mbox{\hyperlink{_lss_communication_8h_a44971e758260958c279fa8c84c7aebaf}{LssDegrees}});}
\DoxyCodeLine{190 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{191 }
\DoxyCodeLine{192     \textcolor{keywordtype}{bool} \mbox{\hyperlink{class_lynx_servo_a0bc1ac9ed3fc6d1db44429584f9b0fc8}{isEnabled}}() \textcolor{keyword}{const};}
\DoxyCodeLine{193 }
\DoxyCodeLine{194     \textcolor{keyword}{inline} \textcolor{keywordtype}{bool} \mbox{\hyperlink{class_lynx_servo_a49462e4aa73bf847238b2ac504eb5241}{isResponsive}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{class_lynx_servo_a7a55721c41d59145b99ceebe98b81462}{timeouts}}==0; \}}
\DoxyCodeLine{195 }
\DoxyCodeLine{196     \textcolor{keyword}{inline} \textcolor{keywordtype}{bool} \mbox{\hyperlink{class_lynx_servo_a4e248c1e41a160bbf8fa512b80c2e984}{isUnresponsive}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{class_lynx_servo_a9b1d3c9e712bf07b1ad032f8c89ed3cc}{enableAfter\_millis}} > 0; \}}
\DoxyCodeLine{197 }
\DoxyCodeLine{198     \textcolor{keywordtype}{void} \mbox{\hyperlink{class_lynx_servo_aa5d29aa5e5aaa08cf22dffddbe9d9f8d}{Write}}(\mbox{\hyperlink{_lss_communication_8h_aca3a41f855f081418aebab290e251f73}{LssCommands}} cmd);}
\DoxyCodeLine{199     \textcolor{keywordtype}{void} \mbox{\hyperlink{class_lynx_servo_aa5d29aa5e5aaa08cf22dffddbe9d9f8d}{Write}}(\mbox{\hyperlink{_lss_communication_8h_aca3a41f855f081418aebab290e251f73}{LssCommands}} cmd, \textcolor{keywordtype}{int} value);}
\DoxyCodeLine{200 }
\DoxyCodeLine{201     \textcolor{keywordtype}{void} \mbox{\hyperlink{class_lynx_servo_a1356206fa1cb03ea7c3ff2e725be35ab}{WritePosition}}(\textcolor{keywordtype}{short} p);}
\DoxyCodeLine{202 }
\DoxyCodeLine{203     \textcolor{comment}{// initiate an asynchronous read of one or more servo registers}}
\DoxyCodeLine{204     \mbox{\hyperlink{class_async_token}{AsyncToken}} \mbox{\hyperlink{class_lynx_servo_a3dea659cb467c45a269c8615741f5fc2}{ReadAsync}}(\mbox{\hyperlink{_lss_communication_8h_aca3a41f855f081418aebab290e251f73}{LssCommands}} commands);}
\DoxyCodeLine{205     \textcolor{keywordtype}{void} \mbox{\hyperlink{class_lynx_servo_a39a83be4e00a4df4cc5d2e482f3ef1b8}{ClearAsync}}(\mbox{\hyperlink{_lss_communication_8h_aca3a41f855f081418aebab290e251f73}{LssCommands}} commands);}
\DoxyCodeLine{206 }
\DoxyCodeLine{207     \textcolor{keywordtype}{void} \mbox{\hyperlink{class_lynx_servo_ab9a5b6ddf6bbe029805658c5670f6800}{dispatch}}(\mbox{\hyperlink{class_lynx_packet}{LynxPacket}} pkt);}
\DoxyCodeLine{208 }
\DoxyCodeLine{209     \textcolor{keywordtype}{void} \mbox{\hyperlink{class_lynx_servo_a73462b8e322998c113b648f4e3690efe}{update}}();}
\DoxyCodeLine{210 }
\DoxyCodeLine{211 }
\DoxyCodeLine{212 \textcolor{preprocessor}{\#if defined(LSS\_STATS)}}
\DoxyCodeLine{213   \textcolor{keyword}{class }\mbox{\hyperlink{class_lynx_servo_1_1_statistics}{Statistics}} \{}
\DoxyCodeLine{214     \textcolor{keyword}{public}:}
\DoxyCodeLine{215       \textcolor{keyword}{struct }\{}
\DoxyCodeLine{216         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{class_lynx_servo_1_1_statistics_a21dcee32c72eefafb3375cd9cd59edde}{transmits}};}
\DoxyCodeLine{217         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{class_lynx_servo_1_1_statistics_a79b094a655b2e53ca3001bf1de1bc15d}{queries}};        \textcolor{comment}{// transmits that expect a response}}
\DoxyCodeLine{218         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{class_lynx_servo_1_1_statistics_a52fc77720c94a72786c72df33e4555b5}{retransmits}};    \textcolor{comment}{// if we detect a missing response we can attempt a retransmit before a timeout occurs}}
\DoxyCodeLine{219         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{class_lynx_servo_1_1_statistics_aded694190a7b38250a80ace88638c871}{received}};}
\DoxyCodeLine{220       \} \mbox{\hyperlink{class_lynx_servo_1_1_statistics_ae51aa3db04f845ec8f819410c9bee112}{packet}};}
\DoxyCodeLine{221 }
\DoxyCodeLine{222       \textcolor{comment}{// a transaction is a group of packets sent at once, and we expect the replies from the servo in the same order}}
\DoxyCodeLine{223       \textcolor{keyword}{struct }\{}
\DoxyCodeLine{224         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{class_lynx_servo_1_1_statistics_a75ada3f71a5c664d2706ae5ea957365c}{complete}};       \textcolor{comment}{// total number of transactions that were completed without error}}
\DoxyCodeLine{225         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{class_lynx_servo_1_1_statistics_a86b403e618d83b8d836a737f56049eef}{partials}};       \textcolor{comment}{// number of transactions that ended in a partial reply but with missing packets and eventually hit timeout}}
\DoxyCodeLine{226         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{class_lynx_servo_1_1_statistics_a87e464e7374c8a67d112e795c035fddd}{timeouts}};       \textcolor{comment}{// servo didnt respond at all (does not include partial replies)}}
\DoxyCodeLine{227         \mbox{\hyperlink{class_aggregate}{Aggregate<unsigned long, unsigned long long>}} \mbox{\hyperlink{class_lynx_servo_1_1_statistics_a262484e24d83a23a12c237738ebb1f34}{responseTime}};}
\DoxyCodeLine{228         \mbox{\hyperlink{class_aggregate}{Aggregate<unsigned long, unsigned long long>}} \mbox{\hyperlink{class_lynx_servo_1_1_statistics_a9cb6be079880f2b2f7676a402da4c051}{completionTime}};}
\DoxyCodeLine{229       \} \mbox{\hyperlink{class_lynx_servo_1_1_statistics_a2b2ccfb12f7a763460bb543663820f43}{transaction}};}
\DoxyCodeLine{230 }
\DoxyCodeLine{231       \mbox{\hyperlink{class_lynx_servo_1_1_statistics_ac5e4fcf9d3df52dfee68bb62dedc3835}{Statistics}}();}
\DoxyCodeLine{232   \};}
\DoxyCodeLine{233   \mbox{\hyperlink{class_lynx_servo_1_1_statistics}{Statistics}}* \mbox{\hyperlink{class_lynx_servo_aa75e8a348ee054a67b757ded60773234}{stats}};}
\DoxyCodeLine{234   \textcolor{keyword}{static} \textcolor{keyword}{const} \mbox{\hyperlink{class_lynx_servo_1_1_statistics}{Statistics}}\& \mbox{\hyperlink{class_lynx_servo_a4900d406aa4936d670f178d35b586852}{globalStatistics}}();}
\DoxyCodeLine{235 \textcolor{preprocessor}{\#endif    }}
\DoxyCodeLine{236 }
\DoxyCodeLine{237 \};}

\end{DoxyCode}
